# Firebase App Hosting configuration for a Next.js app
build:
  run: npm install && npm run build
run:
  run: npm start
backend:
  # This tells App Hosting which secrets are required by the backend.
  # These secrets should have been created in the Google Cloud Secret Manager.
  secrets:
    - FIREBASE_API_KEY
    - FIREBASE_AUTH_DOMAIN
    - FIREBASE_PROJECT_ID
    - FIREBASE_STORAGE_BUCKET
    - FIREBASE_MESSAGING_SENDER_ID
    - FIREBASE_APP_ID
  # This exposes the secrets as environment variables to the Next.js app,
  # allowing the client-side code to connect to Firebase services.
  env:
    - variable: NEXT_PUBLIC_FIREBASE_API_KEY
      value: ${secret:FIREBASE_API_KEY}
    - variable: NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN
      value: ${secret:FIREBASE_AUTH_DOMAIN}
    - variable: NEXT_PUBLIC_FIREBASE_PROJECT_ID
      value: ${secret:FIREBASE_PROJECT_ID}
    - variable: NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET
      value: ${secret:FIREBASE_STORAGE_BUCKET}
    - variable: NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID
      value: ${secret:FIREBASE_MESSAGING_SENDER_ID}
    - variable: NEXT_PUBLIC_FIREBASE_APP_ID
      value: ${secret:FIREBASE_APP_ID}
